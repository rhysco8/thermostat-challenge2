<!DOCTYPE html>
<html>
 <head>
   <title> Thermostat </title>
 </head>
 <body>
   <script src="jquery.js"></script>
   <script src="src/thermostat.js"></script>
   <script>

      $( document ).ready(function() {

        var thermostat = new Thermostat();

        var assignColor = function() {
          if (thermostat.energyUsage() === "low-usage") {
            return 'green';
          } else if (thermostat.energyUsage() === 'medium-usage') {
            return 'black';
          } else if (thermostat.energyUsage() === 'high-usage') {
            return 'red';
          };
        };

        $("#temperature").text(thermostat.temp).css("color", assignColor());

        $("#temperature-up").click(function () {
          thermostat.increase();
          $("#temperature").text(thermostat.temp).css("color", assignColor());
        });

        $("#temperature-down").click(function () {
          thermostat.decrease();
          $("#temperature").text(thermostat.temp).css("color", assignColor());
        });

        $("#temperature-reset").click(function () {
          thermostat.resetTemp();
          $("#temperature").text(thermostat.temp).css("color", assignColor());
        });

        var powerSaveModeStatus = function() {
          if (thermostat.powerSaveMode) {
            return "on";
          } else {
            return "off";
          }
        };

        $("#power-saving-status").text(powerSaveModeStatus());

        $("#powersaving-switch").click(function (){
          thermostat.changePowerSaveMode();
          $("#power-saving-status").text(powerSaveModeStatus());
          $("#temperature").text(thermostat.temp).css("color", assignColor());
        });

        const APP_ID = 'feecd347e0e8923e68041c032c127cef'
        const LONDON_ID = 2643743

        $.get(`http://api.openweathermap.org/data/2.5/weather?id=${LONDON_ID}&APPID=${APP_ID}`, function(weatherResponse) {
          console.log(weatherResponse);
          $("#local-temperature").text(Math.floor(weatherResponse.main.temp - 273.15));
          $("#local-weather").text(weatherResponse.weather[0].description);
        });

      });

   </script>



  <h2> Temperature is <span id='temperature'> </span></h2>
   <br>
   <button id='temperature-down'>-</button>
   <button id='temperature-reset'>reset</button>
   <button id='temperature-up'>+</button>
   <br>
   <h2> Power save mode is <span id="power-saving-status"</span></h2>
   <button id='powersaving-switch'>Toggle Power Save Mode</button>
   <div>
     <h2>Weather in London</h2>
     <h3><span id='local-weather'></span></h3>
     <h3>temperature: <span id='local-temperature'></span></h3>
   </div>

 </body>
</html>
